INSTRUCCIONES PARA APLICAR EL FIX MANUALMENTE:

1. Abrir el archivo: src/produccion/js/ingredientes.js

2. Buscar la funci√≥n (est√° al final del archivo, l√≠nea ~1070):
   window.abrirModalAjusteDesdeTabla = async function(ingredienteId, nombreIngrediente, stockActual) {

3. REEMPLAZAR TODA LA FUNCI√ìN con este c√≥digo:

```javascript
window.abrirModalAjusteDesdeTabla = async function(ingredienteId, nombreIngrediente, stockActual) {
    console.log('‚úèÔ∏è [AJUSTE-JS] Solicitando ajuste para:', nombreIngrediente);
    console.log('üìä [AJUSTE-JS] Vista actual:', vistaActual);
    
    // Detectar usuario_id desde la vista actual
    let usuarioId = null;
    
    if (vistaActual.startsWith('usuario-')) {
        // Extraer ID del usuario desde vistaActual (formato: "usuario-5")
        usuarioId = parseInt(vistaActual.replace('usuario-', ''));
        console.log('üë§ [AJUSTE-JS] Usuario detectado desde vistaActual:', usuarioId);
    } else {
        // Fallback: buscar en el DOM
        const sectorActivo = document.querySelector('.sector-item.activo[data-usuario-id]');
        if (sectorActivo) {
            usuarioId = parseInt(sectorActivo.dataset.usuarioId);
            console.log('üë§ [AJUSTE-JS] Usuario detectado desde DOM:', usuarioId);
        }
    }
    
    if (!usuarioId) {
        alert('‚ö†Ô∏è Error: No se pudo detectar el usuario activo.');
        return;
    }

    // Crear selector oculto para que ajusteRapido.js lo detecte
    let selectorFiltro = document.getElementById('filtro-usuario');
    if (!selectorFiltro) {
        selectorFiltro = document.createElement('select');
        selectorFiltro.id = 'filtro-usuario';
        selectorFiltro.style.display = 'none';
        document.body.appendChild(selectorFiltro);
        console.log('‚úÖ [AJUSTE-JS] Selector filtro-usuario creado');
    }
    selectorFiltro.value = usuarioId;

    // Verificar si ajusteRapido.js carg√≥ la funci√≥n maestra
    if (typeof window.abrirModalAjusteRapido === 'function') {
        console.log('üöÄ [AJUSTE-JS] Llamando a abrirModalAjusteRapido...');
        window.abrirModalAjusteRapido(ingredienteId, nombreIngrediente, stockActual, null);
        
        // Configurar recarga despu√©s del ajuste
        const actualizarOriginal = window.actualizarResumenIngredientes;
        window.actualizarResumenIngredientes = async function() {
            console.log('üîÑ [AJUSTE-JS] Recargando tabla despu√©s del ajuste...');
            await cargarIngredientes(usuarioId);
            window.actualizarResumenIngredientes = actualizarOriginal;
        };
    } else {
        console.error('‚ùå window.abrirModalAjusteRapido no est√° definida.');
        alert('Error: El m√≥dulo de ajustes no est√° cargado correctamente. Recarga la p√°gina con Ctrl+F5.');
    }
};
```

4. Guardar el archivo

5. Reiniciar el servidor: npm start

6. Recargar el navegador con Ctrl+F5

7. Probar: Ir a Ingredientes ‚Üí Seleccionar "Mat√≠as" ‚Üí Verificar que aparece el bot√≥n ‚úèÔ∏è
